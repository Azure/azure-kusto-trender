<!DOCTYPE html>
<html>

<head>
    <!-- boilerplate headers are injected with head.js, grab them from the live example header, or include a link to head.js -->
    <script src="../../boilerplate/head.js"></script>
</head>

<body style="font-family: 'Segoe UI', sans-serif;">
    <div id="availability" style="width: 100%; height: 160px; z-index:1;"></div>
    <script>
        window.onload = function () {
            var kustoTrender = new KustoTrender();
            var availability = new kustoTrender.ux.AvailabilityChart(document.getElementById('availability'));

            var warmResponse = {
                "availability": {
                    "intervalSize": "P3600D",
                    "distribution": {
                        "2011-09-21T00:00:00Z": 19484052,
                        "0001-01-01T00:00:00Z": 9566
                    },
                    "range": {
                        "from": "0001-01-01T00:00:00Z",
                        "to": "2020-10-28T19:22:18.503344Z"
                    }
                },
                "retention": "P7D"
            };
            var coldResponse = {
                "availability": {
                    "intervalSize": "PT12H",
                    "distribution": {
                        "2020-10-28T12:00:00Z": 76476,
                        "2020-06-15T00:00:00Z": 330787,
                        "2020-06-15T12:00:00Z": 219047,
                        "2020-10-28T00:00:00Z": 121100,
                        "2020-10-27T12:00:00Z": 406123,
                        "0001-01-01T00:00:00Z": 9574,
                        "2020-09-03T12:00:00Z": 13726290,
                        "2020-08-15T12:00:00Z": 22074507,
                        "2020-08-16T00:00:00Z": 21008735,
                        "2020-06-30T00:00:00Z": 943779,
                        "2020-06-29T12:00:00Z": 808861,
                        "2020-06-09T00:00:00Z": 1129713,
                        "2020-07-28T00:00:00Z": 118566,
                        "2020-08-16T12:00:00Z": 20902027,
                        "2020-06-26T12:00:00Z": 1228075,
                        "2020-07-30T12:00:00Z": 60856,
                        "2020-08-26T00:00:00Z": 95145,
                        "2020-07-27T12:00:00Z": 158639,
                        "2020-08-25T12:00:00Z": 268657,
                        "2020-07-15T00:00:00Z": 1145814,
                        "2020-08-27T12:00:00Z": 4266744,
                        "2020-07-25T00:00:00Z": 332797,
                        "2020-07-28T12:00:00Z": 76684,
                        "2020-09-29T00:00:00Z": 183976,
                        "2020-07-29T12:00:00Z": 30414,
                        "2020-10-11T12:00:00Z": 240970,
                        "2020-10-12T00:00:00Z": 213149,
                        "2020-07-14T00:00:00Z": 663061,
                        "2020-09-13T12:00:00Z": 28748,
                        "2020-09-14T00:00:00Z": 25248,
                        "2020-09-14T12:00:00Z": 85506,
                        "2020-08-15T00:00:00Z": 22919632,
                        "2020-06-10T00:00:00Z": 1232043,
                        "2020-10-12T12:00:00Z": 159284,
                        "2020-08-20T12:00:00Z": 252848,
                        "2020-06-09T12:00:00Z": 918475,
                        "2020-09-07T12:00:00Z": 25416,
                        "2020-09-08T00:00:00Z": 32755,
                        "2020-09-08T12:00:00Z": 98021,
                        "2020-07-14T12:00:00Z": 1280989,
                        "2020-09-25T12:00:00Z": 78884,
                        "2020-09-26T00:00:00Z": 49914,
                        "2020-09-26T12:00:00Z": 33466,
                        "2020-10-03T12:00:00Z": 290838,
                        "2020-08-12T00:00:00Z": 31523,
                        "2020-08-12T12:00:00Z": 534096,
                        "2020-08-18T00:00:00Z": 26551006,
                        "2020-08-18T12:00:00Z": 22158836,
                        "2020-09-04T00:00:00Z": 7732575,
                        "2020-09-04T12:00:00Z": 19557295,
                        "2020-09-05T00:00:00Z": 31586,
                        "2020-09-05T12:00:00Z": 28894,
                        "2020-09-06T00:00:00Z": 24023,
                        "2020-09-06T12:00:00Z": 1197919,
                        "2020-09-07T00:00:00Z": 23834,
                        "2020-10-09T12:00:00Z": 284732,
                        "2020-10-10T00:00:00Z": 240918,
                        "2020-10-05T12:00:00Z": 310128,
                        "2020-10-06T00:00:00Z": 320176,
                        "2020-10-18T00:00:00Z": 41842,
                        "2020-10-18T12:00:00Z": 41914,
                        "2020-10-19T00:00:00Z": 41875,
                        "2020-10-19T12:00:00Z": 38431,
                        "2020-09-20T00:00:00Z": 13610,
                        "2020-09-20T12:00:00Z": 13309,
                        "2020-09-21T00:00:00Z": 43691,
                        "2020-09-21T12:00:00Z": 20983,
                        "2020-06-11T12:00:00Z": 833715,
                        "2020-07-08T00:00:00Z": 52244,
                        "2020-07-08T12:00:00Z": 11353,
                        "2020-07-09T00:00:00Z": 10490,
                        "2020-07-09T12:00:00Z": 73528,
                        "2020-07-10T00:00:00Z": 6902,
                        "2020-07-10T12:00:00Z": 11935,
                        "2020-07-11T00:00:00Z": 11810,
                        "2020-07-11T12:00:00Z": 6132,
                        "2020-07-12T00:00:00Z": 5823,
                        "2020-07-12T12:00:00Z": 4582,
                        "2020-07-13T00:00:00Z": 72024,
                        "2020-07-13T12:00:00Z": 407814,
                        "2020-09-09T00:00:00Z": 61511,
                        "2020-09-09T12:00:00Z": 63339,
                        "2020-07-29T00:00:00Z": 41344,
                        "2020-06-30T12:00:00Z": 994806,
                        "2020-06-27T00:00:00Z": 1203939,
                        "2020-07-30T00:00:00Z": 23362,
                        "2020-07-22T00:00:00Z": 9102,
                        "2020-09-24T00:00:00Z": 135640,
                        "2020-09-25T00:00:00Z": 153021,
                        "2020-06-19T12:00:00Z": 20443,
                        "2020-09-11T12:00:00Z": 139070,
                        "2020-09-15T00:00:00Z": 58055,
                        "2020-09-15T12:00:00Z": 47347,
                        "2020-09-16T12:00:00Z": 82511,
                        "2020-09-17T00:00:00Z": 56401,
                        "2020-09-17T12:00:00Z": 103572,
                        "2020-09-18T00:00:00Z": 33802,
                        "2020-10-07T12:00:00Z": 509461,
                        "2020-10-08T00:00:00Z": 588096,
                        "2020-07-25T12:00:00Z": 323609,
                        "2020-09-12T00:00:00Z": 64734,
                        "2020-09-12T12:00:00Z": 69587,
                        "2020-09-13T00:00:00Z": 70659,
                        "2020-07-27T00:00:00Z": 383958,
                        "2020-10-27T00:00:00Z": 1521694,
                        "2020-10-01T00:00:00Z": 311637,
                        "2020-10-03T00:00:00Z": 271668,
                        "2020-10-01T12:00:00Z": 321454,
                        "2020-10-11T00:00:00Z": 240829,
                        "2020-10-24T00:00:00Z": 1588626,
                        "2020-08-19T00:00:00Z": 21543631,
                        "2020-10-09T00:00:00Z": 181173,
                        "2020-08-23T00:00:00Z": 49362,
                        "2020-08-23T12:00:00Z": 44631,
                        "2020-08-24T00:00:00Z": 91898,
                        "2020-08-14T00:00:00Z": 8818340,
                        "2020-07-17T12:00:00Z": 13864,
                        "2020-07-18T00:00:00Z": 9604,
                        "2020-07-18T12:00:00Z": 9377,
                        "2020-07-19T00:00:00Z": 9429,
                        "2020-07-19T12:00:00Z": 9326,
                        "2020-06-24T12:00:00Z": 1156294,
                        "2020-06-20T00:00:00Z": 4998,
                        "2020-10-08T12:00:00Z": 544142,
                        "2020-09-24T12:00:00Z": 166279,
                        "2020-06-05T00:00:00Z": 210373,
                        "2020-06-05T12:00:00Z": 6496,
                        "2020-06-06T00:00:00Z": 6113,
                        "2020-06-06T12:00:00Z": 5882,
                        "2020-06-07T00:00:00Z": 6393,
                        "2020-10-06T12:00:00Z": 248160,
                        "2020-10-07T00:00:00Z": 200842,
                        "2020-08-17T00:00:00Z": 20953690,
                        "2020-08-17T12:00:00Z": 25922431,
                        "2020-07-07T00:00:00Z": 12326,
                        "2020-07-07T12:00:00Z": 51429,
                        "2020-09-10T00:00:00Z": 69666,
                        "2020-08-20T00:00:00Z": 740859,
                        "2020-09-02T12:00:00Z": 100658,
                        "2020-08-28T12:00:00Z": 68728,
                        "2020-09-10T12:00:00Z": 96044,
                        "2020-08-03T00:00:00Z": 34125,
                        "2020-08-02T12:00:00Z": 18355,
                        "2020-08-02T00:00:00Z": 7003,
                        "2020-08-03T12:00:00Z": 82953,
                        "2020-06-12T00:00:00Z": 1212817,
                        "2020-06-12T12:00:00Z": 497148,
                        "2020-06-28T12:00:00Z": 1013366,
                        "2020-06-17T12:00:00Z": 21008,
                        "2020-06-18T00:00:00Z": 21733,
                        "2020-10-21T12:00:00Z": 1440280,
                        "2020-10-22T00:00:00Z": 1595061,
                        "2020-10-02T00:00:00Z": 295087,
                        "2020-06-23T12:00:00Z": 981891,
                        "2020-06-26T00:00:00Z": 1207263,
                        "2020-08-25T00:00:00Z": 975042,
                        "2020-09-11T00:00:00Z": 85598,
                        "2020-07-26T00:00:00Z": 321640,
                        "2020-10-25T00:00:00Z": 1589507,
                        "2020-10-25T12:00:00Z": 1545405,
                        "2020-06-17T00:00:00Z": 19322,
                        "2020-05-27T12:00:00Z": 10809,
                        "2020-05-28T00:00:00Z": 30336,
                        "2020-05-28T12:00:00Z": 107505,
                        "2020-05-29T00:00:00Z": 6418,
                        "2020-05-29T12:00:00Z": 134904,
                        "2020-05-30T00:00:00Z": 7815,
                        "2020-05-30T12:00:00Z": 7867,
                        "2020-05-31T00:00:00Z": 7815,
                        "2020-05-31T12:00:00Z": 7631,
                        "2020-06-01T00:00:00Z": 7542,
                        "2020-06-01T12:00:00Z": 198033,
                        "2020-06-02T12:00:00Z": 220489,
                        "2020-06-03T00:00:00Z": 30075,
                        "2020-06-03T12:00:00Z": 164847,
                        "2020-10-26T12:00:00Z": 1543472,
                        "2020-07-24T12:00:00Z": 274503,
                        "2020-07-23T00:00:00Z": 21091,
                        "2020-07-15T12:00:00Z": 511207,
                        "2020-06-27T12:00:00Z": 1185762,
                        "2020-10-23T00:00:00Z": 1977401,
                        "2020-10-23T12:00:00Z": 1615523,
                        "2020-07-01T12:00:00Z": 896250,
                        "2020-07-22T12:00:00Z": 10539,
                        "2020-07-23T12:00:00Z": 20920,
                        "2020-07-24T00:00:00Z": 25126,
                        "2020-06-29T00:00:00Z": 926769,
                        "2020-07-21T12:00:00Z": 337506,
                        "2020-10-13T00:00:00Z": 161279,
                        "2020-10-13T12:00:00Z": 127517,
                        "2020-09-23T12:00:00Z": 157817,
                        "2020-09-01T12:00:00Z": 56198,
                        "2020-09-03T00:00:00Z": 36665,
                        "2020-07-26T12:00:00Z": 403925,
                        "2020-06-08T12:00:00Z": 343598,
                        "2020-09-28T12:00:00Z": 133311,
                        "2020-10-02T12:00:00Z": 320170,
                        "2020-09-29T12:00:00Z": 273720,
                        "2020-10-04T12:00:00Z": 271244,
                        "2020-10-05T00:00:00Z": 347879,
                        "2020-10-10T12:00:00Z": 240981,
                        "2020-08-21T12:00:00Z": 2913110,
                        "2020-08-04T00:00:00Z": 104330,
                        "2020-06-25T00:00:00Z": 1203273,
                        "2020-09-22T00:00:00Z": 37825,
                        "2020-07-31T12:00:00Z": 27803,
                        "2020-08-01T00:00:00Z": 5317,
                        "2020-08-01T12:00:00Z": 4806,
                        "2020-08-04T12:00:00Z": 73920,
                        "2020-06-25T12:00:00Z": 1184245,
                        "2020-07-31T00:00:00Z": 15137,
                        "0001-01-02T12:00:00Z": 536,
                        "5060-03-14T12:00:00Z": 35,
                        "5060-03-15T00:00:00Z": 38,
                        "2020-09-18T12:00:00Z": 58479,
                        "2020-09-27T00:00:00Z": 30199,
                        "2020-09-27T12:00:00Z": 38504,
                        "2020-09-28T00:00:00Z": 44016,
                        "2020-09-30T12:00:00Z": 277503,
                        "2020-08-21T00:00:00Z": 12408,
                        "2020-10-04T00:00:00Z": 265751,
                        "2020-09-30T00:00:00Z": 331221,
                        "2020-07-02T00:00:00Z": 886946,
                        "2020-08-11T12:00:00Z": 66384,
                        "2020-07-02T12:00:00Z": 748795,
                        "2020-07-01T00:00:00Z": 1066019,
                        "2020-06-04T00:00:00Z": 68525,
                        "2020-06-04T12:00:00Z": 344743,
                        "2020-06-07T12:00:00Z": 5951,
                        "2020-06-08T00:00:00Z": 5944,
                        "2020-08-26T12:00:00Z": 3487513,
                        "2020-10-24T12:00:00Z": 1576484,
                        "2020-08-14T12:00:00Z": 9806302,
                        "2020-08-27T00:00:00Z": 37469,
                        "2020-08-28T00:00:00Z": 61124,
                        "2020-08-29T00:00:00Z": 17371,
                        "2020-08-29T12:00:00Z": 27935,
                        "2020-08-30T00:00:00Z": 18756,
                        "2020-08-30T12:00:00Z": 31930,
                        "2020-08-31T00:00:00Z": 6957,
                        "2020-08-31T12:00:00Z": 60003,
                        "2020-08-19T12:00:00Z": 13410021,
                        "2020-08-22T12:00:00Z": 49678,
                        "2020-08-13T12:00:00Z": 2649288,
                        "2020-08-05T00:00:00Z": 40053,
                        "2020-08-05T12:00:00Z": 65284,
                        "2020-08-06T00:00:00Z": 166955,
                        "2020-08-06T12:00:00Z": 78833,
                        "2020-08-07T00:00:00Z": 3445,
                        "2020-08-07T12:00:00Z": 15148,
                        "2020-08-08T00:00:00Z": 10696,
                        "2020-08-08T12:00:00Z": 11275,
                        "2020-08-09T00:00:00Z": 8478,
                        "2020-08-09T12:00:00Z": 8918,
                        "2020-08-10T00:00:00Z": 10431,
                        "2020-08-10T12:00:00Z": 15072,
                        "2020-08-24T12:00:00Z": 1551896,
                        "2020-09-19T00:00:00Z": 21546,
                        "2020-09-19T12:00:00Z": 10858,
                        "2020-09-22T12:00:00Z": 63166,
                        "2020-09-23T00:00:00Z": 58177,
                        "2020-10-26T00:00:00Z": 1594210,
                        "2020-06-28T00:00:00Z": 1206600,
                        "2020-06-18T12:00:00Z": 16632,
                        "2020-07-20T00:00:00Z": 13916,
                        "2020-07-20T12:00:00Z": 59082,
                        "2020-07-21T00:00:00Z": 57232,
                        "2020-10-14T12:00:00Z": 111731,
                        "2020-10-15T00:00:00Z": 111923,
                        "2020-06-16T00:00:00Z": 19794,
                        "2020-06-10T12:00:00Z": 232373,
                        "2020-06-11T00:00:00Z": 28653,
                        "2020-10-22T12:00:00Z": 2038333,
                        "2020-06-14T12:00:00Z": 8485,
                        "2020-07-03T00:00:00Z": 7190,
                        "2020-07-03T12:00:00Z": 8209,
                        "2020-07-04T00:00:00Z": 8221,
                        "2020-07-04T12:00:00Z": 8216,
                        "2020-07-05T00:00:00Z": 8219,
                        "2020-07-05T12:00:00Z": 8218,
                        "2020-07-06T00:00:00Z": 10174,
                        "2020-07-06T12:00:00Z": 10403,
                        "2020-07-16T12:00:00Z": 51859,
                        "2020-07-17T00:00:00Z": 6903,
                        "2020-10-20T12:00:00Z": 27863,
                        "2020-10-21T00:00:00Z": 129910,
                        "2020-08-22T00:00:00Z": 50753,
                        "2020-06-22T12:00:00Z": 16251,
                        "2020-09-02T00:00:00Z": 21876,
                        "2020-09-16T00:00:00Z": 2934,
                        "2020-08-11T00:00:00Z": 29898,
                        "2020-08-13T00:00:00Z": 37904,
                        "2020-07-16T00:00:00Z": 15610,
                        "2020-05-20T12:00:00Z": 15,
                        "2020-06-16T12:00:00Z": 19144,
                        "2020-06-19T00:00:00Z": 2055,
                        "2020-06-20T12:00:00Z": 1975,
                        "2020-06-21T00:00:00Z": 2069,
                        "2020-06-21T12:00:00Z": 1948,
                        "2020-06-22T00:00:00Z": 2615,
                        "2020-06-23T00:00:00Z": 2024,
                        "2020-06-24T00:00:00Z": 3106,
                        "2020-09-01T00:00:00Z": 42404,
                        "2020-10-17T00:00:00Z": 41859,
                        "2020-10-14T00:00:00Z": 90392,
                        "2020-10-15T12:00:00Z": 128435,
                        "2020-10-16T00:00:00Z": 47929,
                        "2020-10-16T12:00:00Z": 51695,
                        "2020-06-02T00:00:00Z": 12083,
                        "2020-06-13T00:00:00Z": 5054,
                        "2020-06-13T12:00:00Z": 4814,
                        "2020-06-14T00:00:00Z": 4855,
                        "2020-10-17T12:00:00Z": 42016,
                        "0051-08-21T12:00:00Z": 2,
                        "2020-10-20T00:00:00Z": 11229
                    },
                    "range": {
                        "from": "0001-01-01T00:00:00Z",
                        "to": "5060-03-15T10:31:41Z"
                    }
                }
            }
            let mergedResponse = kustoTrender.utils.mergeAvailabilities(warmResponse.availability, coldResponse.availability, 'P30D');
            let maxDate = new Date();
            maxDate.setFullYear(maxDate.getFullYear() + 2);
            let minDateString = '1900-01-01T00:00:00Z';
            mergedResponse = kustoTrender.utils.cullValuesOutOfRange(mergedResponse, minDateString, maxDate.toISOString())[0];
            var transformedAvailability = kustoTrender.ux.transformAvailabilityForVisualization(mergedResponse, 500);
            availability.render(transformedAvailability, { legend: 'hidden', theme: 'light', isCompact: false, warmStoreRange: mergedResponse.warmStoreRange }, mergedResponse);
        };
    </script>
</body>

</html>